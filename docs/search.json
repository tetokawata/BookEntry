[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "データ分析: OLS入門",
    "section": "",
    "text": "1 はじめに\n本ページでは、データ分析における基本的な手法の一つである「母平均」および「Population OLS」の推定方法について、その基本概念とともに紹介します。\n特に、「推定対象として定義された母集団上での計算と同じ操作を、実際のデータ上で行う」というシンプルかつ応用の範囲が広い推定の考え方に注目します。 このアプローチは、プラグイン原理（plug-in principle） や アナログ原理（analogy principle） として知られており、より一般的な推定方法の一例としても位置づけられます。\nなお、本ページの議論は、「研究者が定式化」したモデルをどのように計算・推定するのか、に関するものであり、どのようなモデルを定式化すべきか については扱いません。 ただし最終章で、この点について、代表的な議論を簡単に紹介します。\nより詳しく学びたい方には、以下の教科書を推奨します。\n\nAronow and Miller (2019)\n\n\n\n\n\nAronow, Peter M, and Benjamin T Miller. 2019. Foundations of Agnostic Statistics. Cambridge University Press.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>はじめに</span>"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "2  データの要約",
    "section": "",
    "text": "2.1 分布による要約\nデータ分析において、結果を人間が理解できる形で要約することは不可欠です。 これは、分析結果は予測や推薦、社会構造に関する示唆など多様な形で提示されますが、最終的には意思決定者が理解できる形式で示す必要があるためです。\n具体的例を示すために、まずAER packageからCPSSW04データを読み込み、一部の事例を表示します。\nTable 2.1\n\n\nlibrary(tidyverse) # tidyverseパッケージの読み込み\n\ndata(\"CPSSW04\", package = \"AER\") # データの読み込み\n\nhead(CPSSW04) # 一部の事例の抜き出し\n\n  earnings     degree gender age\n1 34.61538   bachelor   male  30\n2 19.23077   bachelor female  30\n3 13.73626 highschool female  30\n4 19.23077   bachelor female  30\n5 19.23077   bachelor   male  25\n6 38.46154   bachelor female  32\nCPSSW04はアメリカの労働者についての調査であり、四つの変数 (所得: earnings, 学位: degree, 性別: gender, 年齢: age) が観察できます。 また合計で 7986 事例が含まれています。\nこのような巨大なデータを直接理解できる人間は、おそらく存在しないでしょう。\nそこで、最も基本的な要約方法は分布表を作成してみます。 分布とは、変数の値が同一である事例数を示します。 例えば、count関数を用いると、学位と性別の分布は次のように計算できます。\ncount(\n  CPSSW04,\n  degree,\n  gender)\n\n      degree gender    n\n1 highschool   male 2772\n2 highschool female 1574\n3   bachelor   male 1901\n4   bachelor female 1739\n\\(n\\) に事例数が表示されています。 例えば、男性で高校卒の事例は2,772件存在することがわかります。\n割合を加えることで、データ全体に占める比率も把握できます。\ndegree gender    n      割合\n1 highschool   male 2772 0.3471074\n2 highschool female 1574 0.1970949\n3   bachelor   male 1901 0.2380416\n4   bachelor female 1739 0.2177561\nCPSSW04において、全体の1/3程度が高校卒の男性であることなどがわかります。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>データの要約</span>"
    ]
  },
  {
    "objectID": "data.html#分布による要約",
    "href": "data.html#分布による要約",
    "title": "2  データの要約",
    "section": "",
    "text": "2.1.1 分布の限界\nCPSSW04には、earningsやageなどの連続変数も含まれています。 これらはCPSSW04データの特徴を理解する上で、非常に重要な変数でしょう。 しかしながら複数の連続変数を含めると、分布表は巨大になり、理解が困難です。\n例えば、earnings, age, degree, genderについて、度数分布表を作成すると、4,649行の表が作成されます。 このような巨大な分布表の理解は、非常に困難です。\nなお少数の連続変数の分布に注目するのであれば、ヒストグラムなどの分布を可視化するツール (Data visualization)を利用することで、人間が認識しやすくできます。 しかしながら複数の変数の分布を可視化することは、困難です。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>データの要約</span>"
    ]
  },
  {
    "objectID": "data.html#平均値による要約",
    "href": "data.html#平均値による要約",
    "title": "2  データの要約",
    "section": "2.2 平均値による要約",
    "text": "2.2 平均値による要約\n分布全体の特徴ではなく、個別の変数の特徴を把握する方法も数多く提案されています。 中でも各変数の分布を、その特徴を表す統計量 (statistics) に要約する方法は有力です。\n最も代表的なものは、平均値です。 例えばearningsの平均値 (平均所得) は、以下の方法で計算結果として定義できます。\n\\[\n平均所得 = \\frac{第1事例の所得 + 第2事例の所得 +...}{事例数}\n\\] 平均値は、分布のみを用いて計算することも可能です。\n\\[\n平均所得 = 1\\times 「所得が1」の割合\n\\] \\[\n+ 2\\times 「所得が2」の割合\n\\tag{2.1}\\]\n無論、どちらの方法でも同じ値が計算されます。\nCPSSW04に含まれるすべての変数について、summary関数は、他の統計量とともに、平均値を計算します。\n\n\n\nTable 2.2\n\n\nsummary(CPSSW04)\n\n    earnings             degree        gender          age       \n Min.   : 2.098   highschool:4346   male  :4673   Min.   :25.00  \n 1st Qu.:10.684   bachelor  :3640   female:3313   1st Qu.:27.00  \n Median :14.904                                   Median :30.00  \n Mean   :16.771                                   Mean   :29.75  \n 3rd Qu.:20.292                                   3rd Qu.:32.00  \n Max.   :61.058                                   Max.   :34.00  \n\n\n\n\nMeanに表示される数値が平均値です。 例えば、CPSSW04データにおける平均年齢は29.75才です。\n\n2.2.1 平均値の限界\n平均値には、変数間の関係性を示さないという問題があります。 例えば、Table 2.2 を見ても、earningsとage,degree,genderの間の関係性について、何もわからないでしょう。\n変数間の関係性を把握する方法には、数多くの提案があります。 ここでは条件付き母平均、および線型モデルを用いる方法を紹介します。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>データの要約</span>"
    ]
  },
  {
    "objectID": "data.html#条件付き平均値による要約",
    "href": "data.html#条件付き平均値による要約",
    "title": "2  データの要約",
    "section": "2.3 条件付き平均値による要約",
    "text": "2.3 条件付き平均値による要約\nもし少数の目的変数と多数の説明変数の関係性を把握することが目標であれば、条件付き分布から計算できる条件付き平均値の利用が有効です。\n条件付き分布は、ある特定の条件を満たす事例内での分布です。 例えば、「大学卒内でのearnings = 1の割合」は以下で計算できます。 \\[\n大学卒内での「所得が1」の事例割合\n\\] \\[\n=\\frac{大学卒かつ「所得が1」の事例割合}{大学卒の事例割合}\n\\]\n条件付き平均値は、ある特定の条件を満たす事例内での平均値です。 例えば、大学卒という条件を満たす平均年齢は以下のように計算できます。\n\\[\n大学卒の平均所得\n\\] \\[\n= 1\\times 大学卒内での「所得が1」の割合\n\\] \\[\n+ 2\\times 大学卒内での「所得が2」の割合 +...\n\\]\n例えば、特定の年齢ごとに条件付き平均賃金を示してみます。\n\nggplot(\n  CPSSW04,\n  aes(\n    x = age,\n    y = earnings\n  )\n) +\n  stat_summary(\n    geom = \"point\"\n  )\n\n\n\n\n\n\n\n\n横軸は年齢、縦軸は平均所得、各点が年齢ごとの条件付き平均賃金を表します。 同図からは、年齢が上がれば、平均所得も上昇する傾向があることがわかります。\n\n2.3.1 条件付き平均値の限界\n説明変数の数が多い場合、大量の条件付き平均値の数が計算されてしまい、理解が困難になります。 例えば、年齢・性別・学位について平均賃金を計算した場合、40 個の組み合わせが発生します。 データの事例数に比べれば、かなり少なくはなりますが、それでも理解には時間がかかるでしょう。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>データの要約</span>"
    ]
  },
  {
    "objectID": "data.html#線型モデルへの要約",
    "href": "data.html#線型モデルへの要約",
    "title": "2  データの要約",
    "section": "2.4 線型モデルへの要約",
    "text": "2.4 線型モデルへの要約\n大量の変数間の関係性を要約するために、線形モデルを適用する方法が広く用いられます。 例えば、賃金と年齢・学位・性別の関係を次のモデルで表すことを目指します。 \\[\n\\beta_0 + \\beta_1\\times age + \\beta_2\\times degree + \\beta_3\\times gender\n\\tag{2.2}\\]\nただしdegreeとgenderの値は、数字ではなく、文字です。 線型モデルに導入する際には、何らかの数字に変換する必要があります。\nここではbachelorとgenderをダミー変数、degreebachelorとgenderfemale、に変換します。 ダミー変数は、以下のように定義されます。\n\ndegreebachelor: degreeがbachelorだった場合は1、その他の場合は0\ngenderfemale: genderがfemaleだった場合は1、その他の場合は0\n\n\\(\\beta_0,\\beta_1,\\beta_2,\\beta_3\\) はパラメタと呼ばれ、モデルがデータに極力一致するように選ばれます。 このようにデータに合うように設定したモデルの特徴を調べることで、データの特徴を大雑把に理解することができます。\n\n2.4.1 OLS\nモデルをデータに適合される典型的な方法はOLS (最小二乗法) です。 具体的な計算方法を紹介する前に、Rでの実行方法から紹介します。 Rでは、lm関数を用いることで、OLSを容易に実行できます。 例えば、以下のコードで、Equation 2.2 を CPSSW04に適合させることができます。\n\n\n\nTable 2.3\n\n\nlm(earnings ~ age + degree + gender, CPSSW04)\n\n\nCall:\nlm(formula = earnings ~ age + degree + gender, data = CPSSW04)\n\nCoefficients:\n   (Intercept)             age  degreebachelor    genderfemale  \n        1.8838          0.4392          6.8651         -3.1579  \n\n\n\n\n各説明変数名の下の数値が、パラメタの計算結果です。 Equation 2.2 のようなシンプルな線型モデルにおいて、パラメタは各説明変数と結果変数であるearningsの「モデル上での関係性」を表します。 推定結果から、年齢や大学卒は賃金と正の関係があり、男性に比べて女性の賃金が低い傾向にあることがわかります。\n\n\n2.4.2 モデルの定式化\n線型モデルに要約することで、変数間の関係性を「ざっくり」把握することができます。 注意が必要なのは、以上の方法では、どのようなモデルをデータに適合させるのかは、分析者が決定する必要がある点です。\nどのようなモデルが適しているのかは、研究目標により異なります。 「人間がデータの大雑把な特徴を理解する」ことを目標にするのであれば、Equation 2.2 のような、シンプルなモデルが有力です。 このような大雑把な理解を目標に設定されたモデルは、記述モデルと呼ばれます1。\n\n\n2.4.3 OLSの計算方法\nOLSの具体的な計算方法を紹介します。 基本的なアイディアは、データとモデルの乖離度合いを測定する指標である、平均二乗誤差を極力小さくするようにパラメタを算出するというものです。\n例えば、ageのみを説明変数として、earningsについて、以下の線形モデルを設定します。 \\[\n\\beta_0 + \\beta_1\\times age\n\\] ある事例 \\(i\\) についての二乗誤差は以下のように定義されます。 \\[\n事例iの二乗誤差=(事例 i の所得 - \\underbrace{(\\beta_0+\\beta_1\\times 事例iのage)}_{モデルが算出する賃金})^2\n\\]\nOLSは全ての事例について、二乗誤差の平均値 (平均二乗誤差)を最小にするようにパラメタを算出します。\n平均値と同様に、OLSも別の計算方法があります。 この方法は、分布と条件付き平均値のみを用いて計算できます。 以下の条件付き平均値についての二乗誤差を最小化するようにパラメタの値を算出します。\n\\[\n(25才の平均所得 - (\\beta_0+\\beta_1\\times 25))^2\\times 25才の割合\n\\] \\[\n+ (26才の平均所得 - (\\beta_0+\\beta_1\\times 26))^2\\times 26才の割合\n\\] \\[\n+...\n\\]\nこちらの計算方法では、パラメタを「モデルが条件付き平均値に極力適合するように決定」するので、算出されたモデルは条件付き母平均のモデルであると解釈できます。 この解釈は、社会データの分析において現実的であり、多くの教科書で採用されています (Angrist and Pischke 2009; Aronow and Miller 2019; Chernozhukov et al. 2025)。\n\n\n2.4.4 線型モデルの限界\n線型モデルは、あくまで関係性を単純化するため、実際の条件付き平均値を完全には反映しません。\n例えばearningsについて、 \\[\n\\beta_0 + \\beta_1\\times age\n\\] をOLSで当てはめてみます。 実際の条件付き平均値とモデルの関係性は、以下でした。\n\nCPSSW04 |&gt; \n  ggplot(\n    aes(\n      x = age,\n      y = earnings\n    )\n  ) +\n  stat_summary(\n    aes(\n      color = \"条件付き平均値\"\n    ),\n    geom = \"point\"\n  ) +\n  geom_smooth(\n    aes(\n      color = \"モデル\"\n    ),\n    method = \"lm\",\n    se = FALSE\n  ) \n\n\n\n\n\n\n\nFigure 2.1\n\n\n\n\n\n各点は年齢ごとの条件付き平均値、直線がOLSで推定された線型モデルとなります。\n線形モデルは、平均賃金と年齢が概ね右上がりの関係 (高年齢は賃金が高い)を捉えることができています。 ただし実際の平均賃金と年齢の関係性は、モデルのように”一直線”ではありません。 線形モデルは、この特徴を捉えることには失敗しています。",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>データの要約</span>"
    ]
  },
  {
    "objectID": "data.html#モデルの複雑化",
    "href": "data.html#モデルの複雑化",
    "title": "2  データの要約",
    "section": "2.5 モデルの複雑化",
    "text": "2.5 モデルの複雑化\nデータ上の平均値とモデルの乖離は、推定するモデルを複雑化することで、簡単に削減できます。 例えば以下のモデルを、OLSでデータに当てはめてみます。 \\[\n\\beta_0 + \\beta_1\\times age + \\beta_2\\times age^2\n\\]\n\\(\\beta_2\\times age^2\\) は高次項と呼ばれます。 このような項を加えても、OLSを用いればパラメータの推定は可能です。\n下図は、この2次モデルをデータに当てはめた結果を示しています。 直線ではなく、年齢に対して曲線的な関係が推定されており、データ上の条件付き平均値により近づいていることがわかります。\n\nCPSSW04 |&gt; \n  ggplot(\n    aes(\n      x = age,\n      y = earnings\n    )\n  ) +\n  stat_summary(\n    aes(\n      color = \"条件付き平均値\"\n    ),\n    geom = \"point\"\n  ) +\n  geom_smooth(\n    aes(\n      color = \"モデル\"\n    ),\n    method = \"lm\",\n    se = FALSE,\n    formula = y ~ poly(x,2)\n  )\n\n\n\n\n\n\n\n\nでは、さらにモデルを複雑にするとどうなるでしょうか？ 次に、9次までの高次項を含む以下のモデルを考えてみます。\n\\[\n\\beta_0 + \\beta_1\\times age+.. + \\beta_9\\times age^9\n\\]\nこのような高次の多項式モデルを用いると、モデルの予測値はデータ上の平均値とほぼ完全に一致するようになります。\n\nCPSSW04 |&gt; \n  ggplot(\n    aes(\n      x = age,\n      y = earnings\n    )\n  ) +\n  stat_summary(\n    aes(\n      color = \"条件付き平均値\"\n    ),\n    geom = \"point\"\n  ) +\n  geom_smooth(\n    aes(\n      color = \"モデル\"\n    ),\n    method = \"lm\",\n    se = FALSE,\n    formula = y ~ poly(x,9)\n  ) \n\n\n\n\n\n\n\n\nこのように、線形回帰モデルは非常に柔軟な枠組みであり、どれほど複雑な形であっても、モデルが”\\(\\beta\\) の足し算”である限り、データに当てはめること自体は可能です。\n複雑なモデルには、以下のような魅力があります。\n\nデータとの適合度が非常に高い\n現実の社会や市場は複雑であるため、モデルも複雑な方が良いと感じられる\n\nしかしながら、複雑すぎるモデルにはいくつかの問題点があります。\n\n過学習（オーバーフィッティング）により、モデルの推定精度が悪化する（詳しくは Section 3.5 を参照）\nモデルの構造が複雑すぎると、人間がその意味を理解しにくくなる（詳しくは Chapter 4 を参照）\n\nそのため、モデルの複雑さは、データの量や研究目標に応じて慎重に調整する必要があります。 具体的な研究目標とそれに応じたOLSの活用方法は、Chapter 4 で紹介します。\n\n\n\n\nAngrist, Joshua D, and Jörn-Steffen Pischke. 2009. Mostly Harmless Econometrics: An Empiricist’s Companion. Princeton university press.\n\n\nAronow, Peter M, and Benjamin T Miller. 2019. Foundations of Agnostic Statistics. Cambridge University Press.\n\n\nChernozhukov, Victor, Christian Hansen, Nathan Kallus, Martin Spindler, and Vasilis Syrgkanis. 2025. Applied Causal Inference Powered by ML and AI. https://causalml-book.org/.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>データの要約</span>"
    ]
  },
  {
    "objectID": "data.html#footnotes",
    "href": "data.html#footnotes",
    "title": "2  データの要約",
    "section": "",
    "text": "データ分析では、記述を目的としないモデルの推定を目指すことがあります。例えば結果変数の値の予測を目指すモデルは、予測モデルと呼ばれます。予想モデルについては、分析者がモデルの詳細な構造を理解することを主たる目的としないため、より複雑なモデルが設定されます。↩︎",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>データの要約</span>"
    ]
  },
  {
    "objectID": "population.html",
    "href": "population.html",
    "title": "3  母集団の要約と推定",
    "section": "",
    "text": "3.1 推定問題の枠組み\n平均値やOLSの結果は、計算に用いるデータによって異なります。 例えば、1947年に実施された第１回目の労働力調査と2025年に行われた調査では、平均賃金が大きく異なるでしょう。 これは1947年と2025年では、社会状況が大きく異なるので、当然の結果と考えられます。\nでは全く同じ社会を対象とした調査を、複数の研究チームが行った場合に、同じ平均賃金が算出されるでしょうか？ もし同じ結果が得られないのでは、分析結果には、「客観性がなく信用できない」とも考えられます。 このような場合、分析結果をどのように受け取れば良いでしょうか？\n以上の問題は、推定問題と呼ばれ、データ分析における中心的な課題の一つです。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>母集団の要約と推定</span>"
    ]
  },
  {
    "objectID": "population.html#推定問題の枠組み",
    "href": "population.html#推定問題の枠組み",
    "title": "3  母集団の要約と推定",
    "section": "",
    "text": "3.1.1 頻度論\n推定問題を考える土台となる枠組みとしては、頻度論とベイズ論が有名です。 本ページでは、頻度論に基づく議論を紹介します。\nまずは、以下の思考実験を考えてください。\n\n\n\n\n\n\nImportant 3.1: 思考実験\n\n\n\n日本全国に、「2025年の日本の労働市場」を分析する研究チームが、大量に組織されました。各チームは同じ手順に基づき、平均賃金を計算します。ただしデータの収集は、各チームが独立して行います。\n果たして、各チームは同じ結論にたどり着くでしょうか？\n\n\nもし全てのチームが同じデータと同じコードを使えば、コーディング・ミスなどがない限り同じ結果になるはずです。 ところが、各チームが電話・ネット調査などでそれぞれが独自にデータを集めた場合、調査対象の対象となった回答者の違いから、得られるデータが異なり、結果も変わる可能性があります。\nこの思考実験の結果を順序立てて想像するために、いくつかの理論的な概念を導入します。\n\n\n3.1.2 推定結果と推定目標\n次の2つを区別することが重要です:\n\n推定結果（estimate）：データから実際に計算される値\n推定目標（parameter of interest/estimand）：推定の対象となる“真の値”\n\nたとえば、CPSSW04データから計算される平均所得は、あくまで「推定結果」であり、「全米の平均所得」という推定目標に近づくことを期待して計算されます。\n推定結果と推定目標の関係性を明確にするために、母集団とサンプルングという概念を導入します。",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>母集団の要約と推定</span>"
    ]
  },
  {
    "objectID": "population.html#母集団とサンプルリング",
    "href": "population.html#母集団とサンプルリング",
    "title": "3  母集団の要約と推定",
    "section": "3.2 母集団とサンプルリング",
    "text": "3.2 母集団とサンプルリング\n\n3.2.1 母集団\n母集団 (Population) とは、推定の対象となる集団のことです。 Important 3.1 における母集団は「2025年の労働者」、CPSSW04では、「2004年のアメリカの全世帯」が妥当な母集団でしょう。\n\n3.2.1.1 母分布\n母分布は、母集団における変数の分布です。 本ページでは、データに含まれる変数について、母集団全員を調査し、計算された分布であるとイメージしてください。\n例えばCPSSW04の母集団である2004年のアメリカの全世帯が観察できれば、同年の 特定の \\([\\) 収入、学位、性別、年齢 \\(]\\) が、全人口に占める割合が計算できるはずです。\n以下では、「分析者は母集団を直接観察できず、母分布を実際に計算することは不可能である」、という状況を想定します。 そして、直接知ることができない母分布やその特徴を、データから推定することを試みます。\n\n\n\n3.2.2 推定目標の定義\n本ページでは、母分布そのものではなく、母分布の特徴を推定する方法を紹介します。 推定の対象となる母分布の特徴を、推定目標と呼びます。 代表的なものとしては、母分布から計算された平均値およびOLSの結果があります。\n\n3.2.2.1 母平均\nデータにおける分布と同様に、母分布からも平均値や条件付き平均値を計算できます。 このような母集団における平均値を、母平均と呼びます。\n例えば、母集団における25才の平均所得は以下のように計算できます。\n\\[\n25才の条件付き母平均\n\\] \\[\n= 1\\times 25才における「earningsが1」の条件付き母分布\n\\] \\[\n+ 2\\times 25才における「earningsが2」の条件付き母分布\n\\] \\[\n+...\n\\]\n\n\n3.2.2.2 Population OLS\n本スライドでは、母分布から計算されるOLSの結果を推定目標とします。 このような推定目標を母集団におけるOLS推定値(Population OLS)と呼びます。\n例えば、賃金と年齢の関係性を捉えるために、以下の母集団における平均二乗誤差を最小化する線型モデル (\\(\\beta_0 + \\beta_1\\times age\\)) をPopulation OLSとして定義できます\n\\[\n(25才の母平均 - (\\beta_0+\\beta_1\\times 25))^2\\times 25才の母分布\n\\] \\[\n+ (26才の母平均 - (\\beta_0+\\beta_1\\times 26))^2\\times 26才の母分布\n\\] \\[\n+...\n\\]\nこれらはすべて、実際には観察できない仮想的な計算結果です。 この結果をデータから推定することを目指します。\n\n\n\n3.2.3 サンプリング\nデータは、何らかの方法で選ばれた事例の集まりであると想定します。 この事例を選ぶ過程を、サンプルング (sampling) と呼びます。\n母集団について推測するためには、データと母集団の関係について何らかの仮定を置く必要があります。 特に、母集団の事例をどれだけ偏りなくサンプリングできているのかは、分析の信頼性に大きく影響します。\n最も重要な仮定は、ランダムサンプリングです。\n\n\n\n\n\n\nImportant 3.2: ランダムサンプルングの仮定\n\n\n\n\nデータの各事例は、母集団から個別にランダムに選ばれている\n\n\n\n本ページでは、分析に用いるデータはランダムサンプルングを満たすことを想定します。\n\n\n3.2.4 推定結果と推定方法\n推定結果（estimate）とは、データから計算される値のことです。 この推定結果は、推定対象（母集団上での真の値）に近い値であることが期待されます。\n推定結果を計算する手順のことを、推定方法（estimator）と呼びます。\n\n\n3.2.5 まとめ\n本節で登場した重要な概念と仮定を整理すると、次のようになります。\n\n\n\n\n\n\nImportant母集団、サンプルング、推定対象、推定結果\n\n\n\n\n母集団: 推定対象となる集団\n\n推定対象: 母集団上で行いたい仮想的な計算 (母集団上で行いたい計算)\n\nサンプルング: 母集団から事例を収集する手順\n\nランダムサンプルングの仮定 (Important 3.2) : 事例は、母集団からランダムに選ばれている\n\nデータ: サンプリングされた事例の集団\n\n推定結果: データから計算される結果 (推定対象に近い値であることが期待される)\n推定方法: データから推定結果を計算する具体的な計算方法\n\n\n\n\nこれらの関係は、以下の図にまとめられます：\n\n\n\n“推定問題”\n\n\n図中の実線は、データの分析者が実際に観察・操作できる要素を、点線は想像上の操作や概念を表しています。 例えば、母集団から推定対象を計算する作業を、分析者が実際に行うことはできません。 なぜならば、母集団を直接観察することができないためです。\n\n\n\n\n\n\nImportantポイント\n\n\n\nここまでの枠組みを用いると、Important 3.1 の思考実験の結果は以下のように整理できます。\n\nデータの事例はランダムに選ばれているため、データから得られる推定結果は研究チームによって異なる",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>母集団の要約と推定</span>"
    ]
  },
  {
    "objectID": "population.html#sec-estimate_by_mean",
    "href": "population.html#sec-estimate_by_mean",
    "title": "3  母集団の要約と推定",
    "section": "3.3 推定方法",
    "text": "3.3 推定方法\n母平均やPopulation OLSは、以下の一般的な推定方法が利用できます1。\n\n\n\n\n\n\nImportant 3.3: 母平均やPopualtion OLSの推定\n\n\n\n\n母集団上での仮想的な計算結果 として、推定対象を定義する\n同じ計算をデータ上で行った結果を、推定結果とする\n\n\n\nこの推定方法は、以下の性質から正当化できます。\n\n\n\n\n\n\nImportant 3.4: 一致性\n\n\n\nもしデータに代表性があり、かつ事例数が無限大であれば、データから算出したOLSの結果とPopulation OLSは一致する。\n\n\n一致性からは、データが増えれば増えるほど、推定結果は推定目標に近づくことが期待できます。\nただし、この議論は「母集団において平均値やOLSの結果が計算できる」ということを、前提にしていることに注意してください。 例えば、母分布が「特殊な」場合、母平均が無限大になり、計算できない場合があります2。 またPopulation OLSについては、母集団において多重共線性 が存在する場合、計算は不可能です。 そのため、多重共線性のない定式化を用いて、Population OLS を定義する必要があります。\n\n3.3.1 一致性の限界\n一致性は、推定方法 Important 3.3 を正当化する重要な性質です。 しかしながら、実際のデータ分析においては、それほど実用的な性質ではありません。 なぜならば、Population OLSとデータ上でのOLSが一致するためには、無限大の事例数 が必要となるからです。 いうまでもなく無限大の事例数を持つデータは存在しません。 言い換えると、実際のデータ分析では、推定結果と推定目標は”乖離している”と想定すべきです。\n具体的な例から考えてみます。\n\nlibrary(tidyverse)\n\ndata(\"CPSSW04\", package = \"AER\")\n\nlm(earnings ~ age, CPSSW04)\n\n\nCall:\nlm(formula = earnings ~ age, data = CPSSW04)\n\nCoefficients:\n(Intercept)          age  \n     3.3242       0.4519  \n\n\n以上の結果は、データ上でのOLSでは、ageのパラメタは0.4519であることが確認できます。 一致性から、もしCPSSW04がランダムサンプルングの仮定を満たし、事例数が無限大であれば、「Population OLS におけるageのパラメタも0.4519である」という結論は必ず正しいものとなります。 ところが実際の事例数は、7986 であり、無限ではありません。 このため「Population OLS におけるageのパラメタも0.4519である」は、ほぼぼ間違った結論となります。\n\n\n\n\n\n\nImportantポイント\n\n\n\nここまでの議論から、Important 3.1 の思考実験の結果は以下のように整理できます。\n\n各研究チームは、ランダムサンプリングにより、データを集めたとする\n\nデータの事例数が無限大あれば、データから得られるOLSの結果は、常にPopulation OLSと一致する\n\nデータから得られる推定結果は、どの研究チームでも同じ\n\n現実的な事例数のもとでは、データから得られるOLSの結果は、常にPopulation OLSから乖離\n\nデータから得られる推定結果は、研究チームよって異なる",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>母集団の要約と推定</span>"
    ]
  },
  {
    "objectID": "population.html#信頼区間",
    "href": "population.html#信頼区間",
    "title": "3  母集団の要約と推定",
    "section": "3.4 信頼区間",
    "text": "3.4 信頼区間\n\n3.4.1 統計的推論\nほぼほぼ間違った結論ではなく、正しい結論を示すことは可能でしょうか？ データ分析においては、確実に正しい結論を示すことは、事実上不可能です。 このため多くのデータ分析では、ほぼほぼ正しい結論を示すことを目指します。 このようなほぼほぼ正しい結論を示すプロセスは、統計的推論と呼ばれます。\n\n\n3.4.2 信頼区間\n統計的推論に活用できるツールは、さまざまなものがあります。 代表的なものとして、信頼区間を紹介します。\n\n\n\n\n\n\nImportant信頼区間\n\n\n\n\n推定対象を一定の確率で含むと考えられる、データから計算される区間\n\n推定対象を含む確率は、信頼確率と呼ばれ、研究者が指定する\n\n\n\n\nRにおいて、信頼区間を計算する方法は複数存在します。 例えばfixestパッケージのfeols関数を用いれば、以下の仮定のもとで、信頼区間を計算します。\n\n\n\n\n\n\nImportant信頼区間計算の前提条件\n\n\n\n\nデータはランダムサンプルングされている\n事例数は十分にある3\n極端なハズレ値がない\n\n\n\n例えば、以下のコードから、reformの平均値について95 \\(\\%\\) 信頼区間を計算できます。\n\n\n\nTable 3.1\n\n\nmodel &lt;- fixest::feols(earnings ~ age, CPSSW04)\n\nconfint(model)\n\n                2.5 %    97.5 %\n(Intercept) 1.3595511 5.2888171\nage         0.3862126 0.5176501\n\n\n\n\n以上の結果から、「Population OLSにおけるageは、概ね (95 \\(\\%\\)) \\(0.387\\sim 0.517\\) である」という主張を行うことができます。\n\n\n3.4.3 信頼区間の解釈\n本ページでは信頼区間の詳細な導出方法の説明は省略します。 代わりに信頼区間の解釈を詳細に紹介します。\n\\(95\\%\\) 信頼区間を活用する際に問題となるのは、 \\(95\\%\\) の意味を正しく捉えることです。 そこで本節では、信頼確率について、いくつかの異なる、ただしすべて正当な解釈を紹介します4。\nまずは 思考実験 Important 3.1 と最も密接な解釈である「繰り返しサンプルング」です。\n\n\n\n\n\n\nImportant解釈1. 多数の研究チーム\n\n\n\n皆さんと他の研究チームは、同じ方法でデータを収集しますが、収集自体は独立して行い、データのシェア等も行いません。 このため、データの特徴は全てのチームで異なっており、計算される信頼区間も異なります。\nこれらの分析チームが各のデータから、95 \\(\\%\\) 信頼区間を計算したとします。 もし信頼区間の仮定が全てのチームで満たされているならば、皆さんを含む大量のチームが計算した信頼区間のうち、95 \\(\\%\\) は推定対象 (真の値)を含みます。\n\n\nこのような解釈は多くの教科書で紹介される標準的なものです。 しかしこの「繰り返しサンプルング」こそが、わかりにくいと指摘されてきた点です。 社会・市場分析において、「同じ母集団を対象に研究する大量の分析チーム」が存在した、現実の例を挙げることが困難なためです。\n2つ目の解釈は「一人の研究者が長期間にわたって大量の研究を行う」という、より現実的な例え話を土台に、信頼区間を分析結果という”生産物”の品質管理として捉える解釈です。\n\n\n\n\n\n\nImportant解釈2. データ分析についての品質保証\n\n\n\nこれから皆さんは長期に渡って、さまざまな母集団 (社会) や研究目標について、多くのデータ分析を行なっていくとします。 これら全ての分析において、信頼区間の仮定が満たされていることを前提に、95 \\(\\%\\) 信頼区間を計算したとします。 当然さまざまな信頼区間が計算されますが、今後皆さんが計算する大量の信頼区間のうち、95 \\(\\%\\) は推定対象 (真の値)を含むことができます。\n\n\nこのような品質保証のような見方を、信頼区間の提唱者であるネイマンは帰納的行動(Inductive Behavior)と呼びました。\n最後に信頼区間は、仮説検定というアプローチと密接な関係があります。 仮説検定の詳細な説明は補論で行いますが、以下のような「消去法」の結果として信頼区間は解釈できます。\n\n\n\n\n\n\nImportant解釈3. 検定の反転\n\n\n\n今、ある推定対象 (例えば改装率)について、候補となる値がたくさん存在します。 この中から、明らかに推定対象ではないと値を除外していきます。 除外する方法は以下です。\n\n仮にある値が推定対象の真の値 (例えば 1 \\(\\%\\)) だと想定する\nもしこの仮の値が、データ上での値とあまりにかけ離れている場合は、真の値の候補から除外する\n全ての値について、１、２を繰り返し、除外されなかった値を信頼区間とする\n\nつまりデータと矛盾しない値の集合を信頼区間とします。\n\n\n検定の反転を実際に行うためには、統計的検定の知識が必要です。 本ページでは紹介しませんが、標準的な統計学・計量経済学の入門書では必ず紹介されています。\nこれらの解釈は、数学的には実は全て同じものであり、解釈のストーリーが違うだけです。 皆さん自身が一番しっくりくるものをとりあえずは選んで問題ありません",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>母集団の要約と推定</span>"
    ]
  },
  {
    "objectID": "population.html#sec-population_overfit",
    "href": "population.html#sec-population_overfit",
    "title": "3  母集団の要約と推定",
    "section": "3.5 複雑すぎるモデルの問題点",
    "text": "3.5 複雑すぎるモデルの問題点\nモデルが複雑すぎると、推定において深刻な問題が生じることがあります。 複雑なモデルのパラメータを高い精度で推定するためには、十分な数の観測事例が必要になるためです。 このためデータ数が限られている場合、複雑なモデルを推定すると、推定精度が大幅に低下し、ミスリードな推定結果を導くおそれがあります。\nここでは、単純な数値例を用いてこの問題を確認してみます。\n\n\n\n\n\n\nImportant数値例\n\n\n\n以下のような複雑な条件付き母平均を想定します5。\n\\[\nE[Y\\mid X] = X + 0.1\\times X^2 + 2\\times X^3 + 0.01\\times X^4 + 5 \\times x^5\n\\] \\[\n0.1 \\times x^6 + 3 \\times x^7 + 0.1 \\times x^8 + 0.1 \\times x^9 + 0.1 \\times x^{10}\n\\tag{3.1}\\]\n\n\n条件付き母平均とこの想定に基づいてランダム・サンプルングされた50事例のデータを図示すると、以下のようになります。\n\n\n\n\n\n\n\n\n\n赤線が条件付き母平均、黒点がデータを表します。\nまずは、単純な線型モデル \\((\\beta_0 + \\beta_1\\times X)\\) を推定してみます。\n\nfixest::feols(\n  Y ~ X,\n  data\n)\n\nこの推定結果と条件付き母平均を比較すると、以下のようになります。\n\n\n\n\n\n\n\n\n\nこの図からわかるように、単純なモデルでは複雑な母平均を捉えることができず、推定結果と母平均に乖離が生じています。\n次に、Equation 3.1 のような複雑な条件付き母平均を想定し、以下のような複雑なモデルを推定してみます。\n\nfixest::feols(\n  Y ~ poly(X,10), # Xの10乗までがモデルに導入されます。\n  data\n)\n\nこの推定結果と条件付き母平均を比較すると、以下のようになります。\n\n\n\n\n\n\n\n\n\n複雑なモデルの方が、条件付き母平均に近づくように思えるかもしれませんが、実際には母平均との乖離がむしろ拡大していることがわかります。 これは、少ないデータ（50事例）で複雑なモデルを推定したため、パラメータの推定精度が著しく低下したことを示しています。\nでは、同じ複雑なモデルを、十分なデータ（5万事例）で推定した場合はどうなるでしょうか。\n\n\n\n\n\n\n\n\n\nこの場合、推定結果は条件付き母平均とほぼ一致しており、十分なデータがあれば、複雑なモデルでもOLSによって高精度な推定が可能であることが確認できます。\nこの数値例からわかるように、複雑なモデルを用いる際には、十分なデータがあるかどうかを慎重に検討する必要があります。\n\n\n\n\nHanley, James A. 2025. “Probabilistic Parameter Estimates That Require Less Small Print.” The American Statistician, no. just-accepted: 1–11.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>母集団の要約と推定</span>"
    ]
  },
  {
    "objectID": "population.html#footnotes",
    "href": "population.html#footnotes",
    "title": "3  母集団の要約と推定",
    "section": "",
    "text": "アナログ原理やプラグイン原理として呼ばれています。↩︎\n母平均が計算できないケースとしては、母分布がコーシー分布である場合などが有名です。↩︎\nどのくらいあれば十分なのかは、難しい問題です。ただし多くの教科書では、200事例以上が基準とされています。↩︎\nHanley (2025)↩︎\n個々の \\(Y\\) と \\(X\\) の値は、以下で決定されます: \\(X=\\) 0から1までの一様分布、 \\[\nY=E[Y\\mid X] + \\underbrace{u}_{平均0,分散1の正規分布}\n\\] ↩︎",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>母集団の要約と推定</span>"
    ]
  },
  {
    "objectID": "nextstep.html",
    "href": "nextstep.html",
    "title": "4  OLSの応用と課題",
    "section": "",
    "text": "4.1 ナイーブな見方: 完璧なモデルの推定\nここまで、あるモデルをどのように推定するかを紹介してきました。 しかし、どのようなモデルを推定すべきかは、研究の目的によって異なります。 本章では、望ましいモデルの定式化について、目的別に整理していきます。 またそれぞれの研究目的について、OLSを用いる際の注意点とOLS以外の手法も紹介します。\nデータ分析を学び始めたばかりの頃、「この手法を使えば社会の真理を明らかにできるのではないか」と期待してしまうことがあります。 言い換えれば、結果変数に対して「完璧でシンプルなモデル」を推定できると考えてしまうかもしれません。\nたとえば、以下のような回帰モデルを用いて、賃金を正確に予測できると期待することがあります。\nTable 4.1\n\n\ndata(\"CPSSW04\", package = \"AER\") # データの読み込み\n\nfixest::feols(earnings ~ degree + age + gender, CPSSW04)\n\nOLS estimation, Dep. Var.: earnings\nObservations: 7,986\nStandard-errors: IID \n                Estimate Std. Error   t value  Pr(&gt;|t|)    \n(Intercept)     1.883797   0.920292   2.04696  0.040695 *  \ndegreebachelor  6.865150   0.178369  38.48856 &lt; 2.2e-16 ***\nage             0.439204   0.030529  14.38664 &lt; 2.2e-16 ***\ngenderfemale   -3.157864   0.180365 -17.50821 &lt; 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\nRMSE: 7.88234   Adj. R2: 0.189694\nしかしながら、このような期待は、少なくとも社会や市場のデータ分析においては、現実的ではありません。 以下の点に注意が必要です。\n以上の理由から、OLSによって「完璧でシンプルなモデル」を推定しようとする試みは、通常うまくいきません。 そのため、分析の目的に応じて、適切なモデルを構築することが現実的なアプローチとなります。",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>OLSの応用と課題</span>"
    ]
  },
  {
    "objectID": "nextstep.html#ナイーブな見方-完璧なモデルの推定",
    "href": "nextstep.html#ナイーブな見方-完璧なモデルの推定",
    "title": "4  OLSの応用と課題",
    "section": "",
    "text": "OLSによって推定されるのは、あくまで「条件付き母平均」のモデルです。つまり、特定の条件（たとえば学歴・性別・年齢）を満たす人々の平均的な賃金を推定しているにすぎません。現実の社会や市場では、同じ条件を持つ人々の間でも賃金には大きなばらつきがあります。たとえば、同じ学歴・性別・年齢であっても、職種や勤務地、経験年数などによって賃金は大きく異なるのが普通です。したがって、モデルが「真の賃金」を正確に予測することは不可能です。\n上記のような単純なモデルでは、現実の平均賃金の構造を十分に表現することはできません。現実の平均賃金と学歴、性別、年齢の関係性は、より複雑であると予想されます。",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>OLSの応用と課題</span>"
    ]
  },
  {
    "objectID": "nextstep.html#全体の特徴の記述",
    "href": "nextstep.html#全体の特徴の記述",
    "title": "4  OLSの応用と課題",
    "section": "4.2 全体の特徴の記述",
    "text": "4.2 全体の特徴の記述\n記述研究とは、データに含まれる情報をもとに、複数の変数の間にどのような関係が存在するのかを明らかにすることを目的とする研究です。\nこのような目的に対して、OLSは非常に有効な分析手法とされています。 OLSは、単純な線形モデルの推定を得意としています。 Table 4.1 のような単純な線形モデルは構造が単純であるため、ある程度データ分析に慣れていれば、どの変数がどのように影響しているのかを人間が理解しやすい形で示すことができます。 例えば、大学卒のパラメタは正なので、平均賃金が高い傾向、女性は平均賃金が低い傾向、年齢と平均賃金は正の関係性が読み取れます。\n\n4.2.1 OLSの注意点\nしかし、OLSを用いる際には注意すべき点もあります。 特に重要なのは、得られた関係性の要約が、どのようなモデルを推定したのか、すなわちモデルの定式化に大きく依存するという点です。 たとえば、どの変数を説明変数として選ぶか、自条項などを加えるかなどの選択によって、分析結果が大きく変わる可能性があります。 そのため、モデルを定式化する段階で、定式化が最終的な解釈や結論に強く影響を与えることを理解しておく必要があります。\n\n\n4.2.2 他の手法\n本ページでは、OLSは条件付き母平均の線型モデルを推定する手法として紹介しました。 言い換えると、条件付き母平均の記述の手法です。\n記述分析の目標は、条件付き母平均のみではありません。 たとえば、母分布そのものの記述を目指す場合には、クラスタリングモデル1などが有効です。 このような分布のモデルを推定する手法としては、最尤推定やベイズ推定法が活用されます。",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>OLSの応用と課題</span>"
    ]
  },
  {
    "objectID": "nextstep.html#予測",
    "href": "nextstep.html#予測",
    "title": "4  OLSの応用と課題",
    "section": "4.3 予測",
    "text": "4.3 予測\n予測研究とは、推定されたモデルを用いて、目的変数 \\(Y\\) の値や未知を予測することを主な目的とする研究です。 たとえば、Table 4.1 で推定されたモデルを用いて、ある個人の属性情報（年齢、学歴）をもとに、その人の賃金を予測する場合などが該当します。\n予測研究と比較研究との大きな違いは、モデルの中身、すなわち各パラメータの意味や解釈が重視されない点にあります。 比較研究では、変数間の関係性を人間が把握することが目的となるため、モデルの理解やパラメータの解釈が重要です。 一方、予測研究では、最終的な予測の精度こそが最も重要な評価基準となります。\nこのため、予測研究では、人間が予測モデルの構造を完全に理解できなくても、大きな問題とはされません。 むしろ、より高い予測精度を実現するために、複雑なモデルが積極的に用いられる傾向があります。 たとえば、以下のような二乗項と交差項 (変数同士の掛け算)を含むモデルが考えられます。\n\\[\nearningsの予測モデル = \\beta_0\n\\] \\[\n+\\beta_1\\times degreebachelor + \\beta_2\\times age + \\beta_3\\times genderfemale\n\\]\n\\[\n+\\beta_5\\times age^2\n\\]\n\\[\n+\\beta_6\\times degreebachelor\\times age + \\beta_7\\times degreebachelor\\times genderfemale\n\\]\n\\[\n+\\beta_7\\times age\\times genderfemale\n\\]\nこのような複雑なモデルであっても、OLSによって推定することが可能です。\n\nmodel &lt;- fixest::feols(\n  earnings ~ degree + age + gender +\n    age^2 + \n    degree:age + degree:gender + age:gender, \n  CPSSW04)\n\ncoef(model)\n\n                (Intercept)              degreebachelor \n               -21.60207344                 -5.33505137 \n                        age                genderfemale \n                 2.11156693                  5.10734867 \n                   I(age^2)          degreebachelor:age \n                -0.02946533                  0.41195443 \ndegreebachelor:genderfemale            age:genderfemale \n                -0.24754070                 -0.27156417 \n\n\n\n4.3.1 OLSの注意点\n予測分析においても、モデルを複雑化することの弊害は存在します。 それは、パラメタの推定精度の悪化に伴う、予測精度の低下です。 予測性能を確保するためには、モデルを複雑にしすぎないことが必要です。\nただし、特に説明変数が多い場合、研究者がモデルの複雑性を適切にコントロールすることは、事実上不可能です。\n\n\n4.3.2 他の手法\n近年では、より柔軟にデータを活用する手法が注目されています。 代表的なものとして、機械学習分野における教師付き学習2があり、経済学の分野でもその応用が急速に進んでいます。 これらの手法は、複雑なモデルであっても予測精度を確保するためのさまざまな工夫が導入されている点が特徴です。",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>OLSの応用と課題</span>"
    ]
  },
  {
    "objectID": "nextstep.html#特定の特徴の記述",
    "href": "nextstep.html#特定の特徴の記述",
    "title": "4  OLSの応用と課題",
    "section": "4.4 特定の特徴の記述",
    "text": "4.4 特定の特徴の記述\nOLSがよく応用されてきた研究課題の一つに、特定の変数間の関係性を明らかにする分析があります。 たとえば、賃金（earnings）と学歴（degree）の関係を調べる研究がその例です。\nこのような課題に対しては、以下のようなシンプルな線形モデルを推定することで、基本的な関係性を把握することができます。\n\nmodel &lt;- fixest::feols(earnings ~ degree, CPSSW04)\n\nconfint(model)[2,] # degreebachelorについての信頼区間を抽出 \n\n                  2.5 %   97.5 %\ndegreebachelor 6.138989 6.855967\n\n\nこの推定結果から、大学卒の方が、概ね 6.14 \\(\\sim\\) 6.86ほど平均賃金が高いと考えられます。\nさらに、OLSを用いることで、賃金と学歴の関係について、より詳細な特徴を捉えることも可能です。 たとえば、「もし大学卒と非大学卒の間で、性別や年齢の分布に違いがなかったとしたら、賃金格差はどうなるか？」という問いに答えることができます。\n実際のデータでは、大学卒と非大学卒の間で性別や年齢の分布に差があります。 こうした差を統計的に調整したうえで賃金を比較するには、直接の関心ではない説明変数（この場合は age や gender）について、より柔軟に定式化したモデルを用いることが有効です。\n以下は、その一例です。\n\n\n\nTable 4.2\n\n\nmodel &lt;- fixest::feols(\n  earnings ~ degree +\n    age + gender +\n    age^2 + age:gender, # genderとageについて交差項と二乗項を導入\n  CPSSW04)\n\nconfint(model)[2,] # degreebachelorについての信頼区間\n\n                2.5 %   97.5 %\ndegreebachelor 6.4815 7.180926\n\n\n\n\nこの推定結果から、大学卒の人の平均賃金は、概ね 6.49 \\(\\sim\\) 7.18ほど高いという結果が得られ、単純なモデルよりも格差がやや広がっていることがわかります。\n予測や全体の記述との違いを明確にするために、極端に対比してみます。\n\n\n\n\n\n\nImportant\n\n\n\n\n予測、全体の特徴の記述、特定の特徴の記述は、すべて \\(Y\\) と \\(X\\) の関係性の推定を目指します。ただし、各 \\(X\\) と \\(Y\\) の個別の関係性の重要性が大きく異なります。\n全体の特徴の記述: すべての \\(X\\) と \\(Y\\) の関係性が等しく重要\n\nすべてのパラメタについて、信頼区間などで推定誤差を考慮したい\n\n予測: 重要なのは、モデルによる予測値の正確性であり、その意味では、各 \\(X\\) と \\(Y\\) の個別の関係性はすべて重要ではない\n\nモデル全体の予測性能は測定したいが、各パラメタについての推定誤差は関心ではない\n\n特定の特徴の記述: \\(X\\) のなかの特定の変数と \\(Y\\) の関係性把握が重要であり、他の \\(X\\) と \\(Y\\) の関係性は重要ではない\n\n関心となる特定のパラメタについて、信頼区間などで推定誤差を考慮したい\n\n\n\n\n\n4.4.1 OLSの注意点\n\n結果の解釈\nこのように推定された差が、社会のどのような特徴を捉えているのかは、以前として不明確です。 例えば、degreebachelorの信頼区間は 6.49 \\(\\sim\\) 7.18であったとしても、「大学進学が賃金を平均的に増加させる因果的効果を持つ」と結論づけることはできません。\nその理由は、degree 間の賃金格差が、age や gender 以外の要因によって生じている可能性があるからです。\nこのように、データから得られた推定結果をもとに因果効果をどのように推論するかという問題は、「統計的因果推論」と呼ばれる分野で活発に研究されています3。\n\n\n推定の信頼性\nTable 4.2 では、関心のある変数 degree と、その他の変数 age や gender の交差項は導入していません。このような場合、degreebachelor の推定結果の解釈が不明瞭になることがあります。\nそのため、degree と他の変数との交差項を導入し、それらの結果を「集計」するというアプローチが推奨されます4。 このような推定は、marginaleffects パッケージを用いることで簡単に実装できます5。\nたとえば、以下のように実行します。\n\nmodel &lt;- fixest::feols(\n  earnings ~ degree +\n    degree:(age + gender +\n              age^2 + age:gender) + # degreeとの交差項  \n    age + gender +\n    age^2 + age:gender, # genderとageについて交差項と二乗項を導入\n  CPSSW04)\n\nmarginaleffects::avg_slopes(\n  model,\n  variables = \"degree\"\n)\n\n\n Estimate Std. Error    z Pr(&gt;|z|)      S 2.5 % 97.5 %\n     6.82      0.178 38.3   &lt;0.001 1064.6  6.47   7.17\n\nTerm: degree\nType: response\nComparison: bachelor - highschool\n\n\nこの結果から、gender と age の分布の違いを統計的に解消した場合、大学卒の人の平均賃金は概ね 6.47 \\(\\sim\\) 7.17 高いと推定されました。\n\n\n\n4.4.2 他の手法\nOLSを用いた比較には、いくつかの問題点が指摘され、それを解消できる手法も開発されてます。 例えば、傾向スコアやエントロピーウェイトなどを活用する方法 (Hainmueller 2012) が有名です6。\nさらに機械学習を活用した信頼性の改善方法も、近年確立されつつあります。 この方法は機械学習の持つ問題点 (信頼区間の計算が難しいなど) を補う仕組みを導入することで、モデルの定式化への推定結果の依存度を下げつつ、推定誤差を考慮した分析が可能になっています7。\n\n\n\n\nChattopadhyay, Ambarish, and José R Zubizarreta. 2023. “On the Implied Weights of Linear Regression for Causal Inference.” Biometrika 110 (3): 615–29.\n\n\nChattopadhyay, Ambarish, and José R. Zubizarreta. 2024. “Causation, Comparison, and Regression.” Harvard Data Science Review 6 (1).\n\n\nChernozhukov, Victor, Christian Hansen, Nathan Kallus, Martin Spindler, and Vasilis Syrgkanis. 2025. Applied Causal Inference Powered by ML and AI. https://causalml-book.org/.\n\n\nDing, Peng. 2023. “A First Course in Causal Inference.” https://arxiv.org/abs/2305.18793.\n\n\n———. 2024. A First Course in Causal Inference. Chapman; Hall/CRC.\n\n\nGormley, Isobel Claire, Thomas Brendan Murphy, and Adrian E Raftery. 2023. “Model-Based Clustering.” Annual Review of Statistics and Its Application 10 (1): 573–95.\n\n\nHainmueller, Jens. 2012. “Entropy Balancing for Causal Effects: A Multivariate Reweighting Method to Produce Balanced Samples in Observational Studies.” Political Analysis 20 (1): 25–46.\n\n\nJames, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani. 2021. An Introduction to Statistical Learning: With Applications in r. 2nd ed. Springer Texts in Statistics. Springer. https://www.statlearning.com/.\n\n\nWager, Stefan. 2024. Causal Inference: A Statistical Learning Approach. Technical report, Stanford University. https://web.stanford.edu/~swager/causal_inf_book.pdf.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>OLSの応用と課題</span>"
    ]
  },
  {
    "objectID": "nextstep.html#footnotes",
    "href": "nextstep.html#footnotes",
    "title": "4  OLSの応用と課題",
    "section": "",
    "text": "Gormley, Murphy, and Raftery (2023)↩︎\nJames et al. (2021)↩︎\nChernozhukov et al. (2025), Wager (2024) , Ding (2024) (ドラフト版: Ding (2023))↩︎\nChattopadhyay and Zubizarreta (2023)↩︎\n詳細は、パッケージのホームページ (https://marginaleffects.com/) を参照ください。↩︎\nOLSが持つ問題点や他の方法を紹介した資料としては、(Chattopadhyay and Zubizarreta 2024)^(https://hdsr.mitpress.mit.edu/pub/1ybwbmlw/release/2) を推奨します。↩︎\nChernozhukov et al. (2025)↩︎",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>OLSの応用と課題</span>"
    ]
  }
]